{% extends "base.html" %}

{% block navbar %}
<!-- Add Area Button -->
<button id="createAreaBtn" class="modern-button">New Area</button>
{% endblock %}

{% block content %}
<section class="discussion-areas">
    {% for area in areas %}
    <a href="{{ url_for('chat.view_area', area_id=area.id) }}" class="discussion-area-link">
        <article class="discussion-area">
            <h2>{{ area.topic }}</h2>
            <p>Threads: <span class="thread-count">{{ area.thread_count }}</span></p>
            <p>Messages: <span class="message-count">{{ area.message_count }}</span></p>
            <p>Last: <time class="last-message">{{ area.last_message }}</time></p>
        </article>
    </a>
    {% endfor %}
</section>
<div id="createAreaModal" class="modal">
    <div class="modal-content">
        <span class="close-btn">&times;</span>
        <form action="{{ url_for('chat.index') }}" method="post" id="createAreaForm">
            <h2>Create New Area</h2>
            <div class="form-group">
                <label for="topicName">Topic:</label>
                <input type="text" id="topicName" name="topic" required>
            </div>
            {% if is_admin %}
            <div class="form-group">
                <div class="custom-checkbox">
                    <input type="checkbox" id="is_secret" name="is_secret">
                    <label for="is_secret">Secret</label>
                </div>
            </div>
            {% endif %}
            <div class="cf-turnstile" data-sitekey="0x4AAAAAAANaDnjjlPmlyDNv"></div>
            <button type="submit" class="modern-button">Create</button>
        </form>
    </div>
</div>
<script>
    // Get the modal
    var modal = document.getElementById("createAreaModal");

    // Get the button that opens the modal
    var btn = document.getElementById("createAreaBtn");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close-btn")[0];

    // When the user clicks the button, open the modal 
    btn.onclick = function() {
        modal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
        modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
</script>
{% endblock %}